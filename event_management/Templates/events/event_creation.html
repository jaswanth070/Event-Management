{% extends "Dashboards/base.html" %}

{% block title %}Organizer | Dashboard{% endblock title %}

{% block header %}Welcome {{ user.first_name }}!!{% endblock header %}

{% block sidebar %}
<li>
    <a href="{% url 'event_create' %}">
        <i class="bi bi-calendar-event"></i> Create Event
    </a>
</li>
<li>
    <a href="#">
        <i class="bi bi-pencil-square"></i> Edit Event <span class="badge">6</span>
    </a>
</li>
<li>
    <a href="#">
        <i class="bi bi-bookmark"></i> Collections
    </a>
</li>
{% endblock sidebar %}

{% block content %}
<h2>Dashboard Overview</h2>
<div class="row mt-4">
    <div class="col-md-4">
        <div class="card p-3">
            <h5>Total Events</h5>
            <p class="metrics">{{ events_count|default:"-" }}</p>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card p-3">
            <h5>Active Participants</h5>
            <p class="metrics">{{ actv_participants|default:"-" }}</p>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card p-3">
            <h5>Upcoming Events</h5>
            <p class="metrics">{{ active_events_count|default:"-" }}</p>
        </div>
    </div>
</div>

<h3 class="mt-5">Your Events</h3>
<div class="row mt-3" id="events-container">
    {% for event in events %}
    <div class="col-md-3 mb-4">
        <div class="event-card card p-3" data-event-id="{{ event.id }}" onclick="getEventDetails('{{ event.id }}')">
            <h5>{{ event.name }}</h5>
            <p><strong>Date:</strong> {{ event.date }}</p>
            <p><strong>Time:</strong> {{ event.time }}</p>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock content %}

{% block extra_js %}
<script>
    function getEventDetails(eventId) {
        $.ajax({
            url: "organizer/event/" + eventId,
            method: "GET",
            success: function (response) {
                // Logic for event details modal
            },
            error: function (xhr, status, error) {
                alert("Failed to fetch event details.");
            }
        });
    }
</script>
{% endblock extra_js %}
